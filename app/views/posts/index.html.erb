<div class="container p-5">
  <div class="row">
    <div class="col">
      <h4>雑学一覧ページ</h4>
    </div>
    <div>
      <%= search_form_for @q do |f| %>
      <%= f.label :title, "キーワード検索" %>
      <%= f.search_field :title_cont, placeholder: "タイトル名で検索" %>
      <%= f.submit "検索" %>
      <% end %>
    </div>
    <div class="pl-5">
      <%= search_form_for @q do |f| %>
        <%= f.label :genre_name, 'ジャンル検索' %>
        <%= f.collection_select :genre_id, Genre.all, :id, :name %>
        <%= f.submit '検索' %>
      <% end %>
    </div>
    </div>
  </div>

  <div class="row p-5">
    <div class="col">
      <table class="table table-borderless text-center">
        <thead>
          <tr>
            <th>ユーザー名</th>
            <th>レベル</th>
            <th>タイトル</th>
            <th>ジャンル</th>
            <th><%= sort_link(@q, :created_at, "投稿日順") %></th>
            <th><%= sort_link(@q, :goods_count, "いいね順") %></th>
            <th><%= sort_link(@q, :comment_count, "コメント順") %></th>
          </tr>
        </thead>
        <tbody>
          <% @posts.each do |post| %>
          <tr>
            <td>
              <%= attachment_image_tag post.user, :image, :fill, 30, 30, fallback: "no_image.jpg" %>
              <%= link_to post.user.name, user_path(post.user_id) %>
            </td>
            <td><%= post.user.level %></td>
            <td><%= link_to post.title, post_path(post) %></td>
            <td><%= post.genre.name %></td>
            <td><%= post.created_at.strftime('%Y/%m/%d') %></td>
            <td><%= post.goods.count %><i class="fas fa-heart pl-2"></i></td>
            <td><%= post.comments.count %>件</td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>